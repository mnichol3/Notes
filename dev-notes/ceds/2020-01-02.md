**Dev Notes - 2 Jan 2020**

# CEDS Gridding Paper Figures



## Issue 1: Error in `gridding_paper_figures.R` when trying to create 1850 openburning plots

The following error is raised when attempting to create historical openburning plots for the year 1850:

```
Error in load_em_nc(nc_file, em, nc_years, years) : 
  Input grid dimensions do not match (lat x lon): 360x720
Calls: plot_em_grids -> Map -> mapply -> <Anonymous> -> load_em_nc
Execution halted
```

### Steps to fix
* Nominal resolution of the `*-em-biomassburning_input4MIPs_emissions_CMIP_VUA-CMIP-BB4CMIP6-1-2_gn_185001-201512.nc` files is 50 km, whereas the nominal resolution of all other `input4MIPS` files is 25 km

* Function calls
  * `generate_all.R`
  
    ```
    100  plot_em_grids(NON_CO2, 'openburning', c(1850, 1980), 'biomassburning',
    101           indir = HISTORICAL_EMS_DIR,
    102          outdir = 'output/gridding-paper-figures',
    103           nc_years = list(default = 1850:2015),
    104           breaks = breaks[NON_CO2])
    ```
    
  * `gridding_paper_figures.R`
    * `plot_em_grids` (104)
      
      ```
      114  em_grids <- Map(load_emissions_grid, nc_files, ems, MoreArgs = list(years, nc_years))
      ```
      
    * `load_emissions_grid` (447)
      
      ```
      459  em_nc_vals <- load_em_nc(nc_file, em, nc_years, years)
      ```
      
    * `load_em_nc` (524)
      
      ```
      548  # Assert that the resolution is 0.5x0.5 degrees
      549  if (nc$dim$lon$len != NLON || nc$dim$lat$len != NLAT) {
      550    nc_close(nc)
      551    stop("Input grid dimensions do not match (lat x lon): ", NLAT, "x", NLON)
      552  }
      ```
